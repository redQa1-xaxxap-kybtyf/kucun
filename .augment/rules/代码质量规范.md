---
type: 'manual'
---

# ä»£ç é£æ ¼è§„èŒƒ

## ğŸ“‹ æ€»åˆ™

æœ¬é¡¹ç›®ä¸¥æ ¼éµå¾ªå…¨æ ˆå¼€å‘æ‰§è¡Œæ‰‹å†Œï¼Œç»“åˆè¡Œä¸šæœ€ä½³å®è·µï¼Œåˆ¶å®šç»Ÿä¸€çš„ä»£ç é£æ ¼è§„èŒƒã€‚

### æ ¸å¿ƒåŸåˆ™

- **ç±»å‹å®‰å…¨ä¼˜å…ˆ**: ç¦ç”¨anyç±»å‹ï¼Œå¼ºåˆ¶æ˜ç¡®ç±»å‹å®šä¹‰
- **çº¦å®šä¼˜äºé…ç½®**: éµå¾ªå·¥å…·å®˜æ–¹æ¨èçš„é»˜è®¤æ–¹å¼
- **ä¸€è‡´æ€§**: æ•´ä¸ªé¡¹ç›®ä¿æŒç»Ÿä¸€çš„ä»£ç é£æ ¼
- **å¯ç»´æŠ¤æ€§**: ä»£ç æ¸…æ™°æ˜“è¯»ï¼Œä¾¿äºå›¢é˜Ÿåä½œ

## ğŸ—ï¸ æ–‡ä»¶å‘½åè§„èŒƒ

### ç›®å½•å‘½å

```
app/                    # Next.js App Router (kebab-case)
components/            # ç»„ä»¶ç›®å½• (kebab-case)
â”œâ”€â”€ ui/               # shadcn/uiç»„ä»¶ (kebab-case)
â””â”€â”€ common/           # ä¸šåŠ¡ç»„ä»¶ (kebab-case)
lib/                  # å·¥å…·åº“ (kebab-case)
```

### æ–‡ä»¶å‘½å

```typescript
// âœ… ç»„ä»¶æ–‡ä»¶ï¼šPascalCaseï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰
Header.tsx;
Button.tsx;
UserProfile.tsx;

// âœ… å·¥å…·æ–‡ä»¶ï¼škebab-case
user - utils.ts;
data - validation.ts;
api - client.ts;

// âœ… ç±»å‹æ–‡ä»¶ï¼škebab-case
user - types.ts;
api - types.ts;
```

## ğŸ“ TypeScriptè§„èŒƒ

### ç±»å‹å®šä¹‰

```typescript
// âœ… æ­£ç¡®ï¼šæ˜ç¡®çš„ç±»å‹å®šä¹‰
interface UserCreateInput {
  name: string;
  email: string;
  role?: UserRole;
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æšä¸¾æé«˜ç±»å‹å®‰å…¨
const enum UserRole {
  ADMIN = 'admin',
  SALES = 'sales',
}

// âŒ é”™è¯¯ï¼šä½¿ç”¨anyç±»å‹
function processData(data: any) {}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ³›å‹
function processData<T>(data: T): T {}
```

### æ¥å£å‘½åçº¦å®š

```typescript
// âœ… æ­£ç¡®ï¼šPascalCaseï¼Œæ— Iå‰ç¼€
interface ButtonProps {
  variant?: 'default' | 'destructive';
  children: React.ReactNode;
}

// âœ… æ­£ç¡®ï¼šç»„ä»¶Propsæ¥å£å‘½å
interface UserCardProps {
  user: User;
  onEdit?: (user: User) => void;
}

// âŒ é”™è¯¯ï¼šä½¿ç”¨Iå‰ç¼€
interface IButtonProps {}
```

### å¯¼å…¥é¡ºåº

```typescript
// âœ… æ­£ç¡®çš„å¯¼å…¥é¡ºåº
// 1. ç¬¬ä¸‰æ–¹åº“
import React from 'react';
import { useQuery } from '@tanstack/react-query';

// 2. ç»å¯¹è·¯å¾„å¯¼å…¥
import { Button } from '@/components/ui/button';
import { createUser } from '@/lib/api/users';

// 3. ç›¸å¯¹è·¯å¾„å¯¼å…¥
import './styles.css';
```

## âš›ï¸ Reactç»„ä»¶è§„èŒƒ

### ç»„ä»¶å®šä¹‰æ–¹å¼

```typescript
// âœ… æ¨èï¼šä½¿ç”¨React.forwardRefï¼ˆé€‚ç”¨äºUIç»„ä»¶ï¼‰
const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ variant = 'default', children, ...props }, ref) => {
    return (
      <button ref={ref} className={cn(buttonVariants({ variant }))} {...props}>
        {children}
      </button>
    );
  }
);

Button.displayName = 'Button';

// âœ… æ¨èï¼šç®­å¤´å‡½æ•°ç»„ä»¶ï¼ˆé€‚ç”¨äºä¸šåŠ¡ç»„ä»¶ï¼‰
const UserProfile = ({ user, onEdit }: UserProfileProps) => {
  return (
    <div className="space-y-4">
      <h2>{user.name}</h2>
      <Button onClick={() => onEdit?.(user)}>ç¼–è¾‘</Button>
    </div>
  );
};

// âœ… å¯é€‰ï¼šå‘½åå‡½æ•°ç»„ä»¶ï¼ˆé€‚ç”¨äºå¤æ‚ç»„ä»¶ï¼‰
function UserDashboard({ userId }: UserDashboardProps) {
  const { data: user } = useQuery({
    queryKey: ['user', userId],
    queryFn: () => fetchUser(userId),
  });

  if (!user) return <div>åŠ è½½ä¸­...</div>;

  return <div>{/* å¤æ‚ç»„ä»¶é€»è¾‘ */}</div>;
}
```

### äº‹ä»¶å¤„ç†å‡½æ•°å‘½å

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨handleå‰ç¼€
const handleSubmit = (data: FormData) => {};
const handleUserEdit = (user: User) => {};
const handleModalClose = () => {};

// âŒ é”™è¯¯ï¼šä¸æ˜ç¡®çš„å‘½å
const onSubmit = () => {};
const click = () => {};
```

### è‡ªå®šä¹‰é’©å­å‘½å

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨useå‰ç¼€
const useUserData = (userId: string) => {};
const useLocalStorage = (key: string) => {};

// âŒ é”™è¯¯ï¼šç¼ºå°‘useå‰ç¼€
const getUserData = () => {};
```

## ğŸ¨ æ ·å¼è§„èŒƒ

### Tailwind CSSä½¿ç”¨

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨Tailwindå·¥å…·ç±»
<div className="flex items-center justify-between p-4 bg-white rounded-lg shadow-sm">
  <h2 className="text-lg font-semibold text-gray-900">æ ‡é¢˜</h2>
  <Button size="sm">æ“ä½œ</Button>
</div>

// âŒ é”™è¯¯ï¼šä½¿ç”¨å†…è”æ ·å¼
<div style={{ display: 'flex', padding: '16px' }}>
  å†…å®¹
</div>

// âŒ é”™è¯¯ï¼šåˆ›å»ºè‡ªå®šä¹‰CSSæ–‡ä»¶
// custom.css
.my-custom-style { ... }
```

### ç»„ä»¶åº“ä½¿ç”¨

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨shan/uiç»„ä»¶
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';

<Button variant="default">ç‚¹å‡»</Button>
<Input placeholder="è¯·è¾“å…¥..." />

// âŒ é”™è¯¯ï¼šç›´æ¥ä½¿ç”¨åŸç”ŸHTMLå…ƒç´ 
<button className="...">ç‚¹å‡»</button>
<input className="..." />
```

## ğŸ”§ çŠ¶æ€ç®¡ç†è§„èŒƒ

### æœ¬åœ°çŠ¶æ€

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨useStateå¤„ç†æœ¬åœ°UIçŠ¶æ€
const [isOpen, setIsOpen] = useState(false);
const [formData, setFormData] = useState<FormData>({});

// âœ… æ­£ç¡®ï¼šä½¿ç”¨useReducerå¤„ç†å¤æ‚çŠ¶æ€
const [state, dispatch] = useReducer(reducer, initialState);
```

### æœåŠ¡å™¨çŠ¶æ€

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨TanStack Queryç®¡ç†æœåŠ¡å™¨çŠ¶æ€
const { data: users, isLoading } = useQuery({
  queryKey: ['users'],
  queryFn: fetchUsers,
});

const createUserMutation = useMutation({
  mutationFn: createUser,
  onSuccess: () => {
    queryClient.invalidateQueries({ queryKey: ['users'] });
  },
});
```

## ğŸ“Š ä»£ç è´¨é‡è¦æ±‚

### æ–‡ä»¶å’Œå‡½æ•°é•¿åº¦é™åˆ¶

```typescript
// âœ… æ–‡ä»¶é•¿åº¦ï¼šä¸è¶…è¿‡300è¡Œ
// âœ… å‡½æ•°é•¿åº¦ï¼šä¸è¶…è¿‡50è¡Œ
// âœ… åœˆå¤æ‚åº¦ï¼šä¸è¶…è¿‡10
// âœ… è®¤çŸ¥å¤æ‚åº¦ï¼šä¸è¶…è¿‡15

// âŒ é”™è¯¯ï¼šè¿‡é•¿çš„å‡½æ•°
function processUserData() {
  // è¶…è¿‡50è¡Œçš„å‡½æ•°é€»è¾‘
}

// âœ… æ­£ç¡®ï¼šæ‹†åˆ†ä¸ºå¤šä¸ªå°å‡½æ•°
function validateUserData(data: UserData) {}
function transformUserData(data: UserData) {}
function saveUserData(data: UserData) {}
```

### é”™è¯¯å¤„ç†

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨TypeScriptçš„neverç±»å‹
function assertNever(value: never): never {
  throw new Error(`Unexpected value: ${value}`);
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨Zodè¿›è¡Œè¿è¡Œæ—¶éªŒè¯
const userSchema = z.object({
  name: z.string().min(1),
  email: z.string().email(),
});

// âœ… æ­£ç¡®ï¼šå¼‚æ­¥æ“ä½œåŒ…å«é”™è¯¯å¤„ç†
try {
  const user = await createUser(userData);
  return { success: true, data: user };
} catch (error) {
  return { success: false, error: error.message };
}
```

## ğŸ”’ å®‰å…¨è§„èŒƒ

```typescript
// âœ… æ­£ç¡®ï¼šéªŒè¯ç”¨æˆ·è¾“å…¥
const sanitizedInput = userSchema.parse(userInput);

// âœ… æ­£ç¡®ï¼šAPIè·¯ç”±èº«ä»½éªŒè¯
export async function POST(request: Request) {
  const session = await getServerSession(authOptions);
  if (!session) {
    return NextResponse.json({ error: 'æœªæˆæƒ' }, { status: 401 });
  }
  // å¤„ç†è¯·æ±‚...
}

// âŒ é”™è¯¯ï¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥
const html = `<div>${userInput}</div>`; // XSSé£é™©
```

## ğŸ“š æ³¨é‡Šè§„èŒƒ

```typescript
/**
 * åˆ›å»ºæ–°ç”¨æˆ·
 * @param userData ç”¨æˆ·æ•°æ®
 * @returns åˆ›å»ºçš„ç”¨æˆ·ä¿¡æ¯
 */
export async function createUser(userData: UserCreateInput): Promise<User> {
  // å¤æ‚ç®—æ³•éœ€è¦è§£é‡Šæ€§æ³¨é‡Š
  const hashedPassword = await bcrypt.hash(userData.password, 12);

  // TODO: æ·»åŠ é‚®ä»¶éªŒè¯åŠŸèƒ½ - è´Ÿè´£äºº: å¼ ä¸‰ - æˆªæ­¢æ—¥æœŸ: 2024-02-01
  return await db.user.create({
    data: { ...userData, password: hashedPassword },
  });
}
```

## âœ… è‡ªåŠ¨åŒ–æ£€æŸ¥

é¡¹ç›®å·²é…ç½®ä»¥ä¸‹è‡ªåŠ¨åŒ–å·¥å…·ï¼š

- **ESLint**: ä»£ç è´¨é‡æ£€æŸ¥
- **Prettier**: ä»£ç æ ¼å¼åŒ–
- **TypeScript**: ç±»å‹æ£€æŸ¥
- **Husky**: Git hooksç®¡ç†
- **lint-staged**: æäº¤å‰æ£€æŸ¥

éµå¾ªè¿™äº›è§„èŒƒï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œé¡¹ç›®çš„é•¿æœŸå¯ç»´æŠ¤æ€§ï¼
