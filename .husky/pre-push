#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” è¿è¡Œpre-pushæ£€æŸ¥..."

# 1. TypeScriptç±»å‹æ£€æŸ¥
echo "ğŸ“ æ£€æŸ¥TypeScriptç±»å‹..."
npm run type-check
if [ $? -ne 0 ]; then
    echo "âŒ TypeScriptç±»å‹æ£€æŸ¥å¤±è´¥ï¼"
    exit 1
fi

# 2. ESLintæ£€æŸ¥
echo "ğŸ” è¿è¡ŒESLintæ£€æŸ¥..."
npm run lint
if [ $? -ne 0 ]; then
    echo "âŒ ESLintæ£€æŸ¥å¤±è´¥ï¼"
    exit 1
fi

# 3. Prettieræ ¼å¼æ£€æŸ¥
echo "ğŸ’… æ£€æŸ¥ä»£ç æ ¼å¼..."
npm run format:check
if [ $? -ne 0 ]; then
    echo "âŒ ä»£ç æ ¼å¼æ£€æŸ¥å¤±è´¥ï¼è¯·è¿è¡Œ npm run format ä¿®å¤æ ¼å¼é—®é¢˜ã€‚"
    exit 1
fi

# 4. æ„å»ºæ£€æŸ¥
echo "ğŸ—ï¸  æ£€æŸ¥é¡¹ç›®æ„å»º..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ é¡¹ç›®æ„å»ºå¤±è´¥ï¼"
    exit 1
fi

echo "âœ… æ‰€æœ‰pre-pushæ£€æŸ¥é€šè¿‡ï¼"
