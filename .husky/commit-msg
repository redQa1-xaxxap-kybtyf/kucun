#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# 验证提交信息格式（Conventional Commits规范）
# 格式：<类型>(<范围>): <描述>
# 示例：feat(auth): add Google OAuth login support

commit_regex='^(feat|fix|docs|style|refactor|perf|test|chore|build|ci|revert)(\(.+\))?: .{1,50}'

if ! grep -qE "$commit_regex" "$1"; then
    echo "❌ 提交信息格式不正确！"
    echo ""
    echo "请使用 Conventional Commits 规范："
    echo "格式：<类型>(<范围>): <描述>"
    echo ""
    echo "类型说明："
    echo "  feat:     新功能"
    echo "  fix:      修复bug"
    echo "  docs:     文档更新"
    echo "  style:    代码格式调整（不影响功能）"
    echo "  refactor: 代码重构"
    echo "  perf:     性能优化"
    echo "  test:     测试相关"
    echo "  chore:    构建过程或辅助工具的变动"
    echo "  build:    构建系统或外部依赖的变动"
    echo "  ci:       CI配置文件和脚本的变动"
    echo "  revert:   回滚之前的提交"
    echo ""
    echo "示例："
    echo "  feat(auth): add Google OAuth login support"
    echo "  fix(ui): correct button spacing in mobile view"
    echo "  docs(api): update API documentation"
    echo "  refactor(components): simplify user card component"
    echo ""
    exit 1
fi

echo "✅ 提交信息格式正确"
