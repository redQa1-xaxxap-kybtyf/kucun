# 开发快速参考卡 - 避免代码冗余

## 🚀 开发前 5 秒检查

### 新增函数前问自己：
1. 这个功能是否已经存在？
2. 应该放在哪个工具文件中？
3. 是否需要添加到现有工具函数？

### 新增常量前问自己：
1. 这个值是否已经定义过？
2. 应该放在哪个常量文件中？
3. 是否应该替换硬编码字符串？

## 📁 快速定位指南

### 我要找工具函数 → 去这里看：
```
lib/utils/index.ts              # 通用工具函数
lib/utils/validation-helpers.ts # 验证函数
lib/utils/style-classes.ts      # 样式工具类
lib/utils/date-helpers.ts       # 日期处理
```

### 我要找常量 → 去这里看：
```
lib/constants/error-messages.ts # 错误消息
lib/constants/status-values.ts  # 状态值
lib/constants/api-endpoints.ts  # API端点
```

### 我要找类型定义 → 去这里看：
```
lib/types/api.ts               # API相关类型
lib/types/common.ts            # 通用类型
lib/types/business.ts          # 业务类型
```

## 🔍 快速搜索命令

### 搜索现有函数：
```bash
grep -r "functionName" lib/ components/ app/
```

### 搜索现有常量：
```bash
grep -r "CONSTANT_NAME" lib/constants/
```

### 搜索错误消息：
```bash
grep -r "错误消息内容" lib/constants/error-messages.ts
```

## ✅ 常用工具函数速查

### 格式化函数
```typescript
import { 
  formatCurrency,    // 货币格式化
  formatDate,        // 日期格式化
  formatDateTime,    // 日期时间格式化
  formatNumber       // 数字格式化
} from '@/lib/utils';
```

### 验证函数
```typescript
import { 
  validateEmail,           // 邮箱验证
  validatePhone,           // 手机号验证
  validateProductionDate,  // 生产日期验证
  validateColorCode,       // 色号验证
  validatePaymentAmount    // 支付金额验证
} from '@/lib/utils/validation-helpers';
```

### 样式工具类
```typescript
import { 
  layoutStyles,      // 布局样式
  formStyles,        // 表单样式
  tableStyles,       // 表格样式
  statusStyles       // 状态样式
} from '@/lib/utils/style-classes';
```

## 🚨 常用错误消息

### API错误消息
```typescript
import { API_ERROR_MESSAGES } from '@/lib/constants/error-messages';

API_ERROR_MESSAGES.UNAUTHORIZED      // '未授权访问'
API_ERROR_MESSAGES.INVALID_INPUT     // '输入数据格式不正确'
API_ERROR_MESSAGES.NOT_FOUND         // '资源不存在'
API_ERROR_MESSAGES.ALREADY_EXISTS    // '资源已存在'
```

### 成功消息
```typescript
import { SUCCESS_MESSAGES } from '@/lib/constants/error-messages';

SUCCESS_MESSAGES.CREATED    // '创建成功'
SUCCESS_MESSAGES.UPDATED    // '更新成功'
SUCCESS_MESSAGES.DELETED    // '删除成功'
```

### 状态值
```typescript
import { STATUS_VALUES } from '@/lib/constants/error-messages';

STATUS_VALUES.ACTIVE      // 'active'
STATUS_VALUES.INACTIVE    // 'inactive'
STATUS_VALUES.PENDING     // 'pending'
```

## 🎨 常用样式组合

### 布局样式
```typescript
import { layoutStyles } from '@/lib/utils/style-classes';

layoutStyles.flexCenter     // 'flex items-center justify-center'
layoutStyles.flexBetween    // 'flex items-center justify-between'
layoutStyles.flexGap2       // 'flex items-center gap-2'
layoutStyles.gridResponsive // 'grid grid-cols-1 md:grid-cols-2 gap-4'
```

### 表单样式
```typescript
import { formStyles } from '@/lib/utils/style-classes';

formStyles.formContainer    // 'space-y-6'
formStyles.buttonGroup      // 'flex items-center gap-2'
formStyles.fieldGroup       // 'space-y-2'
```

## 🛠️ 开发工具命令

### 检查冗余函数
```bash
npx tsx scripts/check-redundant-functions.ts
```

### TypeScript类型检查
```bash
npx tsc --noEmit --skipLibCheck
```

### 代码质量检查
```bash
npx eslint . --ext .ts,.tsx
```

### 格式化代码
```bash
npx prettier --write .
```

## 📝 代码模板

### 新增工具函数模板
```typescript
// lib/utils/your-helpers.ts
/**
 * 功能描述
 * @param param 参数描述
 * @returns 返回值描述
 */
export const yourFunction = (param: ParamType): ReturnType => {
  // 实现逻辑
  return result;
};

// 导出到主文件
// lib/utils/index.ts
export { yourFunction } from './your-helpers';
```

### 新增常量模板
```typescript
// lib/constants/your-constants.ts
export const YOUR_CONSTANTS = {
  VALUE_ONE: 'value_one',
  VALUE_TWO: 'value_two',
} as const;

export type YourConstantType = typeof YOUR_CONSTANTS[keyof typeof YOUR_CONSTANTS];
```

### API路由模板
```typescript
import { NextRequest, NextResponse } from 'next/server';
import { API_ERROR_MESSAGES, SUCCESS_MESSAGES } from '@/lib/constants/error-messages';

export async function POST(request: NextRequest) {
  try {
    // 验证权限
    if (!authorized) {
      return NextResponse.json(
        { success: false, error: API_ERROR_MESSAGES.UNAUTHORIZED },
        { status: 401 }
      );
    }

    // 业务逻辑
    const result = await doSomething();

    return NextResponse.json({
      success: true,
      message: SUCCESS_MESSAGES.CREATED,
      data: result,
    });
  } catch (error) {
    return NextResponse.json(
      { success: false, error: API_ERROR_MESSAGES.INTERNAL_ERROR },
      { status: 500 }
    );
  }
}
```

## 🎯 记住这些原则

1. **先搜索，再创建** - 避免重复实现
2. **统一来源** - 每个概念只有一个权威定义
3. **类型安全** - 所有工具函数都要有类型定义
4. **文档完整** - 复杂函数要有注释说明
5. **测试覆盖** - 重要工具函数要有单元测试

---

**💡 提示：将此文档加入书签，开发时随时查阅！**
