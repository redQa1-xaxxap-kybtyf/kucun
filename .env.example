# ========================================
# 库存管理系统 - 环境变量配置模板
# ========================================
# 重要提示:
# 1. 复制此文件为 .env.local (开发) 或 .env.production (生产)
# 2. 填写所有必需的环境变量
# 3. 绝对不要提交包含真实密钥的 .env 文件到版本控制
# ========================================

# ========================================
# 核心配置
# ========================================
# 运行环境 (development|production|test)
NODE_ENV=production

# 应用端口 (灵活配置，支持任意端口)
PORT=3000

# Next-Auth 配置
# 密钥必须至少32位，生成命令: openssl rand -base64 32
NEXTAUTH_SECRET=your-secret-key-change-this-in-production-min-32-chars
# 生产环境必需，格式: https://your-domain.com 或 http://localhost:3000
NEXTAUTH_URL=http://localhost:3000

# ========================================
# 数据库配置
# ========================================
# 开发环境 SQLite (无需安装数据库服务)
# DATABASE_URL=file:./prisma/dev.db

# 生产环境 MySQL (推荐)
DATABASE_URL=mysql://user:password@localhost:3306/kucun?schema=public

# 生产环境 PostgreSQL (可选)
# DATABASE_URL=postgresql://user:password@localhost:5432/kucun?schema=public

# ========================================
# Redis 缓存配置
# ========================================
# Redis 连接URL
REDIS_URL=redis://127.0.0.1:6379

# Redis 连接池大小 (推荐 3-10)
REDIS_POOL_SIZE=3

# Redis 缓存命名空间前缀
REDIS_NAMESPACE=kucun

# ========================================
# WebSocket 配置 (无硬编码端口依赖)
# ========================================
# WebSocket 服务端口 (可灵活配置)
WS_PORT=3002

# 客户端 WebSocket 端口 (必须以 NEXT_PUBLIC_ 开头)
NEXT_PUBLIC_WS_PORT=3002

# 允许的 WebSocket Origin (逗号分隔，生产环境必需配置)
# 示例: https://yourdomain.com,https://www.yourdomain.com
WS_ALLOWED_ORIGINS=

# ========================================
# 安全配置
# ========================================
# bcrypt 加密强度 (10-12推荐，更高更安全但更慢)
BCRYPT_SALT_ROUNDS=12

# 用户密码最小长度 (6-20)
USER_PASSWORD_MIN_LENGTH=8

# 最大登录失败次数
USER_MAX_LOGIN_ATTEMPTS=5

# 会话超时时间 (分钟)
USER_SESSION_TIMEOUT=90

# ========================================
# 文件上传/存储配置
# ========================================
# 上传目录
UPLOAD_DIR=./public/uploads

# 最大文件大小 (字节, 10485760 = 10MB)
UPLOAD_MAX_SIZE=10485760

# 存储加密密钥 (必须32-64字符)
STORAGE_ENCRYPTION_KEY=your-32-char-or-longer-encryption-key-change-this

# 存储区域 (七牛云等)
STORAGE_REGION=z0

# 最大文件大小 (字节)
STORAGE_MAX_FILE_SIZE=10485760

# 允许的文件类型 (逗号分隔)
STORAGE_ALLOWED_FILE_TYPES=jpg,jpeg,png,pdf,doc,docx,xls,xlsx

# ========================================
# 缓存配置
# ========================================
# 产品缓存时间 (秒)
PRODUCT_CACHE_TTL=60

# 库存缓存时间 (秒, 较短保证数据新鲜)
INVENTORY_CACHE_TTL=10

# 财务数据缓存时间 (秒)
FINANCE_CACHE_TTL=300

# 供应商缓存时间 (毫秒)
SUPPLIER_CACHE_TTL=300000

# ========================================
# 库存阈值配置
# ========================================
# 默认最小库存阈值
INVENTORY_DEFAULT_MIN_QUANTITY=10

# 紧急库存阈值
INVENTORY_CRITICAL_MIN_QUANTITY=5

# 库存过多倍率
INVENTORY_OVERSTOCK_MULTIPLIER=5

# 最大库存倍数
INVENTORY_MAX_STOCK_MULTIPLIER=50

# 平均日销量假设值
INVENTORY_AVERAGE_DAILY_SALES=2

# 库存预警刷新间隔 (毫秒)
INVENTORY_ALERT_REFRESH_INTERVAL=300000

# 库存预警返回数量限制
INVENTORY_ALERT_LIMIT=20

# ========================================
# 分页配置
# ========================================
# 默认分页大小
DEFAULT_PAGE_SIZE=20

# 最大分页大小
MAX_PAGE_SIZE=100

# ========================================
# 业务模块配置
# ========================================
# 产品配置
PRODUCT_LIST_INCLUDE_INVENTORY=false
PRODUCT_LIST_INCLUDE_STATISTICS=false
PRODUCT_CACHE_WITH_INVENTORY_TTL=60
PRODUCT_CACHE_WITHOUT_INVENTORY_TTL=30

# 销售订单配置
SALES_ORDER_PREFIX=SO
SALES_ORDER_NUMBER_LENGTH=4
ORDER_NUMBER_MAX_RETRY=10
ORDER_NUMBER_RECENT_LIMIT=5

# 客户配置
CUSTOMER_SEARCH_LIMIT=5
CUSTOMER_TAG_LIMIT=10

# 仪表盘配置 (毫秒)
DASHBOARD_STALE_TIME=300000
DASHBOARD_REFETCH_INTERVAL=60000

# 厂家发货配置
FACTORY_SHIPMENT_ORDER_PREFIX=FS
FACTORY_SHIPMENT_QUERY_LIMIT=1000

# 退货/退款配置
REFUND_ORDER_PREFIX=REF
RETURN_ORDER_PREFIX=RT
RETURN_ORDER_ITEMS_LIMIT=50
REFUND_BATCH_LIMIT=50

# 财务配置
FINANCE_CREDIT_LIMIT=100000

# 供应商配置
SUPPLIER_QUERY_LIMIT=100
SUPPLIER_DEFAULT_STATUS=active

# ========================================
# 系统基础设置
# ========================================
# 默认语言
SYSTEM_DEFAULT_LANGUAGE=zh

# 公司名称
SYSTEM_COMPANY_NAME=库存管理系统

# 系统时区
SYSTEM_TIMEZONE=Asia/Shanghai

# ========================================
# 日志配置
# ========================================
# 日志级别 (error|warn|info|debug)
LOG_LEVEL=info

# 日志保留天数
LOG_RETENTION_DAYS=30

# 关键日志行为 (逗号分隔)
LOG_CRITICAL_ACTIONS=login,logout,delete,update_settings

# 关键日志类型 (逗号分隔)
LOG_CRITICAL_TYPES=security,system,error

# 关键日志级别 (逗号分隔)
LOG_CRITICAL_LEVELS=error,warn,info

# ========================================
# 端口/协议灵活配置说明
# ========================================
# 本系统已移除所有硬编码的端口和协议依赖:
# 1. 验证码服务: 基于Redis，无HTTP调用
# 2. WebSocket: 自动检测协议 (ws/wss)，端口从环境变量读取
# 3. PM2配置: 所有端口从环境变量读取
# 4. 支持任意端口部署，支持反向代理 (Nginx/Caddy)
# 
# 部署示例:
# - 开发: PORT=3000 WS_PORT=3002
# - 生产: PORT=8080 WS_PORT=8081 (通过Nginx反向代理到80/443)
# - Docker: PORT=3000 WS_PORT=3002 (容器内部端口，映射到宿主机)
